{% extends "base.html" %}
{% load static %}

{% block title %}≈†ank{% endblock %}

{% block extra_head %}
<style>
/* ========================================
   ≈†ANK MODUL - MODERNIZOVAN SA LOW STOCK
   ======================================== */

/* DASHBOARD KARTICE */
.stats-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: transform 0.3s, box-shadow 0.3s;
    text-align: center;
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
}

.stat-card i {
    font-size: 2.5em;
    margin-bottom: 15px;
    opacity: 0.9;
}

.stat-card h3 {
    font-size: 2em;
    margin: 10px 0;
    font-weight: bold;
}

.stat-card p {
    font-size: 0.95em;
    opacity: 0.85;
    margin: 5px 0;
}

.stat-card.blue { color: #4facfe; }
.stat-card.purple { color: #667eea; }
.stat-card.pink { color: #f093fb; }
.stat-card.green { color: #43e97b; }

body.dark-theme .stat-card {
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.2));
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* SECTION KARTICE */
.section-card {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    padding: 25px;
    margin: 20px 0;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

body.dark-theme .section-card {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.section-header {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 2px solid rgba(255, 255, 255, 0.2);
}

.section-header i {
    font-size: 1.8em;
    margin-right: 15px;
}

.section-header h2 {
    margin: 0;
    font-size: 1.5em;
}

/* FORME - GRID LAYOUT */
.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
}

.form-group {
    display: flex;
    flex-direction: column;
}

.form-group label {
    margin-bottom: 8px;
    font-weight: 600;
    font-size: 0.95em;
    color: #e0e0e0;
}

body.dark-theme .form-group label {
    color: #fff;
}

.form-group input,
.form-group select {
    padding: 12px 15px;
    border-radius: 10px;
    border: 2px solid rgba(255, 255, 255, 0.2);
    background: rgba(255, 255, 255, 0.9);
    color: #333;
    font-size: 1em;
    transition: all 0.3s;
}

body.dark-theme .form-group input,
body.dark-theme .form-group select {
    background: rgba(0, 0, 0, 0.5);
    color: #fff;
    border: 2px solid rgba(255, 255, 255, 0.3);
}

.form-group input:focus,
.form-group select:focus {
    outline: none;
    border-color: #00bfff;
    box-shadow: 0 0 15px rgba(0, 191, 255, 0.3);
}

/* DUGMIƒÜI */
.btn-primary {
    background: linear-gradient(135deg, #00bfff, #0099cc);
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 10px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(0, 191, 255, 0.3);
    font-size: 1em;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 191, 255, 0.4);
}

.btn-success {
    background: linear-gradient(135deg, #43e97b, #38d278);
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 10px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(67, 233, 123, 0.3);
}

.btn-success:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(67, 233, 123, 0.4);
}

/* ========================================
   LOW STOCK UPOZORENJA - NOVA FUNKCIONALNOST!
   ======================================== */

/* LOW STOCK BADGE - Pored imena proizvoda u tabeli */
.low-stock-badge {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.75em;
    font-weight: bold;
    margin-left: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.low-stock-critical {
    background: linear-gradient(135deg, #ff4444, #cc0000);
    color: white;
    animation: pulse 2s infinite;
}

.low-stock-warning {
    background: linear-gradient(135deg, #ffa500, #ff8c00);
    color: white;
}

.low-stock-ok {
    background: linear-gradient(135deg, #43e97b, #38d278);
    color: white;
}

/* HIGHLIGHT CELOG REDA U TABELI */
tr.stock-critical {
    background: rgba(255, 68, 68, 0.2) !important;
    border-left: 5px solid #ff4444 !important;
}

tr.stock-warning {
    background: rgba(255, 165, 0, 0.15) !important;
    border-left: 5px solid #ffa500 !important;
}

body.dark-theme tr.stock-critical {
    background: rgba(255, 68, 68, 0.3) !important;
}

body.dark-theme tr.stock-warning {
    background: rgba(255, 165, 0, 0.25) !important;
}

/* PULSIRANJE ANIMACIJA ZA KRITIƒåNE */
@keyframes pulse {
    0%, 100% {
        box-shadow: 0 0 10px rgba(255, 68, 68, 0.5);
    }
    50% {
        box-shadow: 0 0 20px rgba(255, 68, 68, 0.8);
    }
}

/* LOW STOCK STATISTIKA KARTICA */
.low-stock-summary {
    background: linear-gradient(135deg, rgba(255, 68, 68, 0.2), rgba(255, 165, 0, 0.2));
    border-left: 5px solid #ff4444;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 15px;
}

.low-stock-summary i {
    font-size: 2em;
    color: #ff4444;
}

.low-stock-summary .summary-text {
    flex: 1;
}

.low-stock-summary .summary-text h4 {
    margin: 0 0 5px 0;
    font-size: 1.1em;
    color: #ff4444;
}

.low-stock-summary .summary-text p {
    margin: 0;
    font-size: 0.9em;
    opacity: 0.9;
}

/* ========================================
   OSTALI STILOVI
   ======================================== */

/* TABELA */
.table-container {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    margin-top: 20px;
}

body.dark-theme .table-container {
    background: rgba(0, 0, 0, 0.6);
}

.table-container table {
    margin: 0;
    background: transparent;
}

.table-container th {
    background: linear-gradient(135deg, #2a5298, #1e3c72);
    color: #fff;
    padding: 15px 12px;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.9em;
    letter-spacing: 0.5px;
}

body.dark-theme .table-container th {
    background: linear-gradient(135deg, #4a5568, #2c3e50);
}

.table-container td {
    padding: 12px;
    vertical-align: middle;
}

.table-container tr:hover {
    background: rgba(0, 191, 255, 0.1) !important;
}

body.dark-theme .table-container tr:hover {
    background: rgba(255, 255, 255, 0.05) !important;
}

/* AUTOCOMPLETE */
#autocomplete-list {
    position: absolute;
    background: white;
    border: 2px solid #00bfff;
    border-radius: 10px;
    max-height: 250px;
    overflow-y: auto;
    z-index: 1000;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
    width: calc(100% - 4px);
}

body.dark-theme #autocomplete-list {
    background: #1a1a1a;
    border-color: #00bfff;
}

.autocomplete-item {
    padding: 12px 15px;
    cursor: pointer;
    transition: all 0.2s;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

body.dark-theme .autocomplete-item {
    border-bottom-color: rgba(255, 255, 255, 0.1);
}

.autocomplete-item:hover {
    background: linear-gradient(135deg, #00bfff, #0099cc);
    color: white;
}

/* RESPONSIVE */
@media (max-width: 768px) {
    .stats-row {
        grid-template-columns: 1fr;
    }
    
    .form-grid {
        grid-template-columns: 1fr;
    }
    
    .section-card {
        padding: 15px;
    }
}

/* ANIMACIJE */
@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.section-card {
    animation: slideIn 0.5s ease-out;
}

.stat-card:nth-child(1) { animation-delay: 0.1s; }
.stat-card:nth-child(2) { animation-delay: 0.2s; }
.stat-card:nth-child(3) { animation-delay: 0.3s; }
.stat-card:nth-child(4) { animation-delay: 0.4s; }
</style>
{% endblock %}

{% block content %}
<div style="max-width: 1400px; margin: 0 auto;">
    
    <!-- NASLOV -->
    <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="font-size: 2.5em; margin-bottom: 10px;">
            <i class="fas fa-shopping-cart"></i> ≈†ANK - UPRAVLJANJE I PRODAJA
        </h1>
        <p style="opacity: 0.8; font-size: 1.1em;">Trenutno stanje: {% now "d.m.Y H:i" %}</p>
    </div>

    <!-- STATISTIKA DASHBOARD -->
    <div class="stats-row">
        <div class="stat-card blue">
            <i class="fas fa-euro-sign"></i>
            <h3>{{ danas_zarada|floatformat:2 }} ‚Ç¨</h3>
            <p>Zarada danas</p>
        </div>
        
        <div class="stat-card purple">
            <i class="fas fa-shopping-bag"></i>
            <h3>{{ danas_prodato }}</h3>
            <p>Proizvoda prodato</p>
        </div>
        
        <div class="stat-card pink">
            <i class="fas fa-box"></i>
            <h3>{{ ukupno_proizvoda }}</h3>
            <p>Ukupno proizvoda</p>
        </div>
        
        <div class="stat-card green">
            <i class="fas fa-trophy"></i>
            <h3>{{ najprodavaniji|default:"N/A" }}</h3>
            <p>Najprodavaniji danas</p>
        </div>
    </div>

    <!-- ========================================
         LOW STOCK UPOZORENJE - NOVA SEKCIJA!
         ======================================== -->
    {% with low_stock_critical=stocks|length|add:0 low_stock_warning=0 %}
        {% for stock in stocks %}
            {% if stock.kolicina < 5 %}
                {% with low_stock_critical=low_stock_critical|add:1 %}{% endwith %}
            {% elif stock.kolicina < 10 %}
                {% with low_stock_warning=low_stock_warning|add:1 %}{% endwith %}
            {% endif %}
        {% endfor %}
        
        {% if low_stock_critical > 0 or low_stock_warning > 0 %}
        <div class="low-stock-summary">
            <i class="fas fa-exclamation-triangle"></i>
            <div class="summary-text">
                <h4>‚ö†Ô∏è NISKE ZALIHE UPOZORENJE</h4>
                <p>
                    {% if low_stock_critical > 0 %}
                        <strong style="color: #ff4444;">{{ low_stock_critical }} proizvoda</strong> ima manje od 5 komada (KRITIƒåNO!)
                    {% endif %}
                    {% if low_stock_warning > 0 %}
                        | <strong style="color: #ffa500;">{{ low_stock_warning }} proizvoda</strong> ima manje od 10 komada
                    {% endif %}
                </p>
            </div>
        </div>
        {% endif %}
    {% endwith %}

    <!-- DODAVANJE NOVOG PROIZVODA -->
    <div class="section-card">
        <div class="section-header">
            <i class="fas fa-plus-circle" style="color: #43e97b;"></i>
            <h2>Dodaj novi proizvod</h2>
        </div>
        <form method="post">
            {% csrf_token %}
            <div class="form-grid">
                <div class="form-group">
                    <label>Naziv proizvoda</label>
                    <input type="text" name="naziv" placeholder="npr. ROSA - Voda 0.5" required>
                </div>
                <div class="form-group">
                    <label>Poƒçetna koliƒçina</label>
                    <input type="number" name="kolicina" placeholder="20" min="0" required>
                </div>
                <div class="form-group">
                    <label>Cena (EUR)</label>
                    <input type="number" step="0.01" name="cena" placeholder="1.50" min="0" required>
                </div>
                <div class="form-group" style="display: flex; align-items: flex-end;">
                    <button type="submit" name="add_product" class="btn-success" style="width: 100%;">
                        <i class="fas fa-plus"></i> Dodaj
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- A≈ΩURIRANJE ZALIHA -->
    <div class="section-card">
        <div class="section-header">
            <i class="fas fa-boxes" style="color: #4facfe;"></i>
            <h2>A≈æuriraj zalihe</h2>
        </div>
        <form method="post">
            {% csrf_token %}
            <div class="form-grid">
                <div class="form-group">
                    <label>Izaberi proizvod</label>
                    <select name="stock_id" required>
                        <option value="">-- Izaberi --</option>
                        {% for stock in stocks %}
                        <option value="{{ stock.id }}">{{ stock.naziv }} ({{ stock.kolicina }} kom)</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label>Dodatna koliƒçina</label>
                    <input type="number" name="dodatna_kolicina" placeholder="10" min="1" required>
                </div>
                <div class="form-group" style="display: flex; align-items: flex-end;">
                    <button type="submit" name="update_stock" class="btn-primary" style="width: 100%;">
                        <i class="fas fa-sync-alt"></i> A≈æuriraj
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- NOVA PRODAJA -->
    <div class="section-card">
        <div class="section-header">
            <i class="fas fa-cash-register" style="color: #f093fb;"></i>
            <h2>Nova prodaja</h2>
        </div>
        <form method="post" id="sale-form">
            {% csrf_token %}
            {{ sale_form.non_field_errors }}
            <div class="form-grid">
                <div class="form-group" style="position: relative;">
                    <label>Pretra≈æi klijenta</label>
                    <input type="text" id="clan-search" placeholder="Poƒçni kucati ime..." autocomplete="off">
                    <input type="hidden" name="clan" id="clan-id" required>
                    <div id="autocomplete-list"></div>
                </div>
                <div class="form-group">
                    <label>Proizvod</label>
                    <select name="stock" id="stock-select" required>
                        <option value="">-- Izaberi proizvod --</option>
                        {% for stock in stocks %}
                        <option value="{{ stock.id }}" data-price="{{ stock.cena }}">
                            {{ stock.naziv }} ({{ stock.kolicina }} kom @ {{ stock.cena }}‚Ç¨)
                        </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label>Koliƒçina</label>
                    <input type="number" name="kolicina" id="quantity-input" placeholder="1" min="1" value="1" required>
                </div>
                <div class="form-group">
                    <label>Ukupna cena</label>
                    <input type="text" id="total-price" readonly style="font-weight: bold; font-size: 1.2em; color: #00bfff;">
                </div>
            </div>
            <div style="margin-top: 20px;">
                <button type="submit" class="btn-success" style="width: 100%; font-size: 1.1em; padding: 15px;">
                    <i class="fas fa-check-circle"></i> POTVRDI PRODAJU
                </button>
            </div>
        </form>
    </div>

    <!-- ========================================
         TRENUTNE ZALIHE SA LOW STOCK HIGHLIGHT
         ======================================== -->
    <div class="section-card">
        <div class="section-header">
            <i class="fas fa-warehouse" style="color: #667eea;"></i>
            <h2>Trenutne zalihe</h2>
            <span style="margin-left: auto; font-size: 0.9em; opacity: 0.7;">
                <span class="low-stock-critical" style="padding: 5px 10px; margin: 0 5px;">üî¥ < 5</span>
                <span class="low-stock-warning" style="padding: 5px 10px; margin: 0 5px;">üü° < 10</span>
                <span class="low-stock-ok" style="padding: 5px 10px; margin: 0 5px;">üü¢ OK</span>
            </span>
        </div>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Proizvod</th>
                        <th>Koliƒçina</th>
                        <th>Cena</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for stock in stocks %}
                    <tr {% if stock.kolicina < 5 %}class="stock-critical"{% elif stock.kolicina < 10 %}class="stock-warning"{% endif %}>
                        <td>
                            <strong>{{ stock.naziv }}</strong>
                            {% if stock.kolicina < 5 %}
                                <span class="low-stock-badge low-stock-critical">üî¥ KRITIƒåNO!</span>
                            {% elif stock.kolicina < 10 %}
                                <span class="low-stock-badge low-stock-warning">üü° NISKO</span>
                            {% endif %}
                        </td>
                        <td style="font-size: 1.2em; font-weight: bold;">
                            {{ stock.kolicina }} kom
                        </td>
                        <td>{{ stock.cena }} ‚Ç¨</td>
                        <td>
                            {% if stock.kolicina < 5 %}
                                <span class="low-stock-badge low-stock-critical">NARUƒåI!</span>
                            {% elif stock.kolicina < 10 %}
                                <span class="low-stock-badge low-stock-warning">PAZI</span>
                            {% else %}
                                <span class="low-stock-badge low-stock-ok">OK</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- ISTORIJA PRODAJE -->
    <div class="section-card">
        <div class="section-header">
            <i class="fas fa-history" style="color: #43e97b;"></i>
            <h2>Istorija prodaje (poslednje)</h2>
        </div>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Klijent</th>
                        <th>Proizvod</th>
                        <th>Koliƒçina</th>
                        <th>Cena</th>
                        <th>Datum/Vreme</th>
                    </tr>
                </thead>
                <tbody>
                    {% for sale in sales|slice:":20" %}
                    <tr>
                        <td><strong style="color: #00bfff;">{{ sale.clan.ime_prezime }}</strong></td>
                        <td>{{ sale.stock.naziv }}</td>
                        <td>{{ sale.kolicina }} kom</td>
                        <td style="font-weight: bold;">{{ sale.price }} ‚Ç¨</td>
                        <td style="font-size: 0.9em;">
                            {{ sale.datum|date:"d.m.Y" }}<br>
                            <strong>{{ sale.datum|time:"H:i" }}</strong>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

</div>

<!-- MODAL ZA MINUS UPOZORENJE -->
<div class="modal fade" id="minusModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content" style="background: #1a1a1a; color: white; border: 2px solid #ff4444;">
            <div class="modal-header" style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                <h5 class="modal-title">
                    <i class="fas fa-exclamation-triangle" style="color: #ff4444;"></i>
                    UPOZORENJE: Minus!
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p id="modal-message" style="font-size: 1.1em;"></p>
            </div>
            <div class="modal-footer" style="border-top: 1px solid rgba(255,255,255,0.1);">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Odustani</button>
                <button type="button" class="btn btn-danger" id="confirm-sale">Potvrdi prodaju</button>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap 5 JS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
// STOCK PRICES OBJEKAT
const stockPrices = {{ stocks_json|safe }};

// AUTOCOMPLETE SA DEBOUNCE
let debounceTimer;
const searchInput = document.getElementById('clan-search');
const autocompleteList = document.getElementById('autocomplete-list');
const clanIdInput = document.getElementById('clan-id');

searchInput.addEventListener('input', function() {
    clearTimeout(debounceTimer);
    const query = this.value.trim();
    
    if (query.length < 2) {
        autocompleteList.innerHTML = '';
        autocompleteList.style.display = 'none';
        return;
    }
    
    debounceTimer = setTimeout(() => {
        fetch(`/sank/json/clanovi/?q=${encodeURIComponent(query)}`)
            .then(response => response.json())
            .then(data => {
                autocompleteList.innerHTML = '';
                if (data.length === 0) {
                    autocompleteList.innerHTML = '<div class="autocomplete-item">Nema rezultata</div>';
                } else {
                    data.forEach(clan => {
                        const div = document.createElement('div');
                        div.className = 'autocomplete-item';
                        div.textContent = clan.ime_prezime;
                        div.onclick = function() {
                            searchInput.value = clan.ime_prezime;
                            clanIdInput.value = clan.id;
                            autocompleteList.style.display = 'none';
                            
                            // Uƒçitaj kredite
                            fetch(`/krediti/json/${clan.id}/`)
                                .then(r => r.json())
                                .then(d => {
                                    console.log(`${d.ime_prezime} ima ${d.krediti_voda}‚Ç¨ kredita`);
                                });
                        };
                        autocompleteList.appendChild(div);
                    });
                }
                autocompleteList.style.display = 'block';
            });
    }, 300);
});

// IZRAƒåUNAJ UKUPNU CENU
const stockSelect = document.getElementById('stock-select');
const quantityInput = document.getElementById('quantity-input');
const totalPriceInput = document.getElementById('total-price');

function calculateTotal() {
    const selectedOption = stockSelect.options[stockSelect.selectedIndex];
    const price = parseFloat(selectedOption.dataset.price) || 0;
    const quantity = parseInt(quantityInput.value) || 0;
    const total = (price * quantity).toFixed(2);
    totalPriceInput.value = total + ' ‚Ç¨';
}

stockSelect.addEventListener('change', calculateTotal);
quantityInput.addEventListener('input', calculateTotal);

// PROVERA MINUS I MODAL
const saleForm = document.getElementById('sale-form');
const minusModal = new bootstrap.Modal(document.getElementById('minusModal'));
let formSubmitted = false;

saleForm.addEventListener('submit', function(e) {
    if (formSubmitted) return;
    
    e.preventDefault();
    
    const clanId = clanIdInput.value;
    const stockId = stockSelect.value;
    const quantity = parseInt(quantityInput.value);
    
    if (!clanId || !stockId || !quantity) {
        toastr.error('Popunite sva polja!');
        return;
    }
    
    const selectedOption = stockSelect.options[stockSelect.selectedIndex];
    const price = parseFloat(selectedOption.dataset.price);
    const totalCost = price * quantity;
    
    fetch(`/krediti/json/${clanId}/`)
        .then(response => response.json())
        .then(data => {
            const krediti = parseFloat(data.krediti_voda);
            const noviKrediti = krediti - totalCost;
            
            if (noviKrediti < 0) {
                document.getElementById('modal-message').innerHTML = 
                    `<strong>${data.ime_prezime}</strong> ƒáe nakon ove kupovine imati <strong style="color: #ff4444;">${noviKrediti.toFixed(2)}‚Ç¨</strong> kredita (MINUS!). <br><br>Da li ≈æelite da nastavite?`;
                minusModal.show();
            } else {
                formSubmitted = true;
                saleForm.submit();
            }
        });
});

document.getElementById('confirm-sale').addEventListener('click', function() {
    formSubmitted = true;
    minusModal.hide();
    saleForm.submit();
});
</script>

{% endblock %}
